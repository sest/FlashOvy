function Trace(a,b,c){if(Trace.isEnabled){var d=a;if(null!=b){var e="";try{e="Function"==typeof b?b.name.toString()+"();":b.toString()}catch(f){try{e=b.toString()}catch(g){e="null"}}d=e+" => "+d}Trace.displayOnScreen?(Trace._onScreenDiv||(Trace._onScreenDiv=document.createElement("div"),Trace._onScreenDiv.style.position="absolute",Trace._onScreenDiv.style.width="200px",Trace._onScreenDiv.style.height="300px",Trace._onScreenDiv.style.overflowY="scroll",Trace._onScreenDiv.style.color="#00ff00",Trace._onScreenDiv.style.padding="10px",Trace._onScreenDiv.style.zIndex=2e7,Trace._onScreenDiv.style.left="20px",Trace._onScreenDiv.style.top="20px",Trace._onScreenDiv.style.fontFamily="Courier New",Trace._onScreenDiv.style.fontSize="10px",Trace._onScreenDiv.style.backgroundColor="#000000",Trace._fieldLines=[]),Trace._fieldLines.push(d),Trace._fieldLines.length>Trace.onScreenMaxLines&&Trace._fieldLines.shift(),Trace._onScreenDiv.innerHTML=Trace._fieldLines.join("<br />"),document.body.appendChild(Trace._onScreenDiv)):!0===trace._consoleAvailable&&(null!=c?console.log("%c"+d,c):console.log(d))}Trace._traceArray.push(d)}function AssetGroup(a,b){return this.data=a,b.onComplete&&(this.onComplete=b.onComplete),null!==b.customPath&&(this.customPath=b.customPath),b.onUpdate&&(this.onUpdate=b.onUpdate),b.dataURIFile&&(this.dataURIFile=b.dataURIFile),b.dataURIFileSizeInBytes&&(this.dataURIFileSizeInBytes=b.dataURIFileSizeInBytes),this.dataURIFilePercentageOfTotal=b.dataURIFilePercentageOfTotal?b.dataURIFilePercentageOfTotal:0,this.stripPath=b.stripPath?b.stripPath:!1,this}function Event(){}function MouseEvent(){}function KeyboardEvent(){}function TouchEvent(){}function MutationEvent(){}function MessageEvent(){}function MediaEvent(){}function MouseAndTouchEvent(){}!function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]="function"==typeof c[g]&&"function"==typeof e[g]&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return d.prototype=f,d.prototype.constructor=d,d.extend=arguments.callee,d}}();var Utils=function(a){function b(){return Utils.isScrollbar()?document.documentElement.clientWidth-Utils.SCROLLBAR_WIDTH:document.documentElement.clientWidth}function c(){return window.innerHeight}function d(){return AppModel.scrolledView.offsetWidth!=document.getElementById("mainPM").offsetWidth}function e(){var a=document.createElement("div");a.style.width="100%",a.style.height="100%",a.style.overflow="scroll",a.style.position="-9999px",a.style.top="absolute",a.className="scrollbar-measure",document.body.appendChild(a);var b=a.offsetWidth-a.clientWidth;return document.body.removeChild(a),b}function f(a,b){var c=a.apply(a,b);return c._super=c._super||{},c.override=function(a,b){void 0!==this[a]&&(this._super[a]=this[a]),this[a]=b},c}function g(a){switch(a){case"1":case"true":case"yes":return!0;case"0":case"false":case"no":case"undefined":case void 0:return!1;default:return void 0!=typeof a}}function h(a){return a.replace(/(\s)([\S])[\s]+/g,"$1$2&nbsp;")}function i(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}function j(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="; expires="+d.toGMTString()}else var e="";document.cookie=a+"="+b+e+"; path=/"}function k(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null}function l(a){j(a,"",-1)}function m(a,b,c,d){var e=c.bind(d);return a.addEventListener(b,e),e}function n(a,b,c){a.removeEventListener(b,c)}var o=0;return a.extend=f,a.stringToBoolean=g,a.addEmbedEvent=m,a.removeEmbedEvent=n,a.removeWidows=h,a.getParameterByName=i,a.eraseCookie=l,a.readCookie=k,a.createCookie=j,a.getScrollbarWidth=e,a.isScrollbar=d,a.getWindowHeight=c,a.getWindowWidth=b,a.SCROLLBAR_WIDTH=o,a}({});Trace.checkConsole=function(){var a=!1;return"undefined"!=typeof console&&(a=!0),a};var trace=Trace;Trace.isEnabled=1,Trace.displayOnScreen=!1,Trace.onScreenMaxLines=50,Trace._onScreenDiv=null,Trace._fieldLines=null,Trace._traceArray=[],Trace._consoleAvailable=Trace.checkConsole(),function(){function a(){function c(){for(p;q>p;p++)o=g[p],b.assetExist(o)||(s.push(g[p]),t++);if(0<s.length){var a=0,c=s.length;for(a;c>a;a++){if(n=new Image,o=s[a],n.addEventListener("load",d,!0),n.addEventListener("error",e,!0),n.style.position="absolute",/\//.test(s[a])&&b.que[0].stripPath){var h=s[a],j=void 0;h&&(j=h.replace(RegExp("^.*[/]","g"),"")),o=j}url=null!=i?i+s[a]:b.assetPath+s[a],b.assets.push({asset:n,id:o,isURI:!1}),n.src=url+(""!==b.assetVersion?"?v=":"")+b.assetVersion}}else f()}function d(a){a.currentTarget.removeEventListener("load",f,!0),a.currentTarget.removeEventListener("error",f,!0),r++,f()}function e(a){a.currentTarget.removeEventListener("load",f,!0),a.currentTarget.removeEventListener("error",f,!0),r++,f()}function f(){b._percentageLoaded=Math.ceil(r/t*(100-m)+m),null!=j&&j(b._percentageLoaded),r==t&&(h&&h(),b.que.shift(),0<b.que.length?setTimeout(a,100):b.busy=!1)}b._percentageLoaded=0;var g=b.que[0].data,h=b.que[0].onComplete,i=b.que[0].customPath,j=b.que[0].onUpdate,k=b.que[0].dataURIFile,l=b.que[0].dataURIFileSizeInBytes,m=b.que[0].dataURIFilePercentageOfTotal;"Explorer"==BrowserDetect.BROWSER_NAME&&9>=BrowserDetect.BROWSER_VERSION&&(k=null,m=0);var n,o,p=0,q=g.length,r=0,s=[],t=0;if(null!=k){var u=function(a){v.removeEventListener(Event.LOAD,u,!0),a=a.currentTarget.responseText.split("|");for(var d=0;d<a.length-1;d++){var e=a[d];if(0==d%2){var f=new Image;f.src=a[d+1],b.assets.push({asset:f,id:e.toString(),isURI:!0})}}v=null,c()},k=k+(""!==b.assetVersion?"?v=":"")+b.assetVersion,v=new XMLHttpRequest;v.addEventListener("progress",function(a){b._percentageLoaded=Math.ceil(a.loaded/l*m),b._percentageLoaded>m&&(b._percentageLoaded=m),null!=j&&j(b._percentageLoaded)},!1),v.addEventListener(Event.LOAD,u,!0),v.open("GET",k,!0),v.overrideMimeType&&v.overrideMimeType("text/plain; charset=x-user-defined"),v.send(null)}else c()}var b={assetVersion:"",init:function(a,c){b.initialized||(b.assetVersion=c||"",b.assets=[],b.que=[],b.busy=!1,b.assetPath=a,b._percentageLoaded=0,b.initialized=!0)},loadGroup:function(c){if(!b.initialized)throw Error("You need to initialize AssetManager before loading a group");b.busy?b.que.push(c):(b.busy=!0,b.que.push(c),a())},getAsset:function(a){if(!b.initialized)throw Error("You need to initialize AssetManager before attempting to retrive an asset - id: "+a);var c=0,d=b.assets.length,e=null;for(c;d>c;c++)if(a===b.assets[c].id)return c=b.assets[c].asset,e=c.cloneNode(!0),e.style.position="absolute",-1<a.indexOf("@2")?(a=c.width/2,c=c.height/2,e.width=a,e.height=c):(a=c.width,c=c.height),e.width=a,e.height=c,e._orgW=a,e._orgH=c,e._ratio=c/a,e;throw Error("AssetManager -> asset with id: "+a+", not found")},destroy:function(a){if(!b.initialized)throw Error("You need to initialize AssetManager before attempting to destroy an asset - id: "+a);var c=0,d=b.assets.length;for(c;d>c;c++)if(a===b.assets[c].id){b.assets[c]=null,b.assets.splice(c,1);break}},assetExist:function(a){var c=0,d=b.assets.length;for(c;d>c;c++)if(a===b.assets[c].id)return!0;return!1}};window.AssetManager=b}();var BrowserDetect={init:function(){BrowserDetect.MOBILE=BrowserDetect.checkMobile(),BrowserDetect.TABLET=BrowserDetect.checkTablet(),BrowserDetect.MOBILE||BrowserDetect.TABLET||(BrowserDetect.DESKTOP=!0),BrowserDetect.MOBILE?BrowserDetect.DEVICE="mobile":BrowserDetect.TABLET?BrowserDetect.DEVICE="tablet":BrowserDetect.DESKTOP&&(BrowserDetect.DEVICE="desktop"),BrowserDetect.BROWSER_NAME=this.searchString(this.dataBrowser)||"An unknown browser",BrowserDetect.BROWSER_VERSION=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",BrowserDetect.OS=this.searchString(this.dataOS)||"an unknown OS",window.chrome&&!window.chrome.webstore&&(BrowserDetect.BROWSER_NAME="Opera"),"Firefox"==BrowserDetect.BROWSER_NAME?BrowserDetect.FIREFOX=!0:"Chrome"==BrowserDetect.BROWSER_NAME?BrowserDetect.CHROME=!0:"Safari"==BrowserDetect.BROWSER_NAME?BrowserDetect.SAFARI=!0:"Explorer"==BrowserDetect.BROWSER_NAME?BrowserDetect.IE=!0:"Opera"==BrowserDetect.BROWSER_NAME&&(BrowserDetect.OPERA=!0),BrowserDetect.IE&&8>=BrowserDetect.BROWSER_VERSION&&(BrowserDetect.IE8=!0),BrowserDetect.IE&&9==BrowserDetect.BROWSER_VERSION&&(BrowserDetect.IE9=!0),BrowserDetect.IE&&10==BrowserDetect.BROWSER_VERSION&&(BrowserDetect.IE10=!0),"Mozilla"==BrowserDetect.BROWSER_NAME&&11==BrowserDetect.BROWSER_VERSION&&(BrowserDetect.IE11=!0),BrowserDetect.FIREFOX&&10<=BrowserDetect.BROWSER_VERSION&&(BrowserDetect.TRANSLATE3D_SUPPORT=!0)},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;if(BrowserDetect.BROWSER_VERSIONSearchString=a[b].versionSearch||a[b].identity,c){if(-1!=c.indexOf(a[b].subString))return a[b].identity}else if(d)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(BrowserDetect.BROWSER_VERSIONSearchString);return-1!=b?parseFloat(a.substring(b+BrowserDetect.BROWSER_VERSIONSearchString.length+1)):void 0},getOlderSafariVersion:function(a){return 100>a?1:125.2>a?1.1:312.1>a?1.2:412>a?1.3:523.1>a?2:523.12>=a?3:void 0}};BrowserDetect.dataBrowser=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],BrowserDetect.dataOS=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.userAgent,subString:"Windows CE",identity:"Windows CE"},{string:navigator.userAgent,subString:"Palm",identity:"Palm"},{string:navigator.userAgent,subString:"Blackberry",identity:"Blackberry"},{string:navigator.platform,subString:"Linux",identity:"Linux"}],BrowserDetect.checkMobile=function(){var a=/iphone|ipod|kindle|android|blackberry|opera mini|opera mobi|skyfire|maemo|windows phone|palm|iemobile|symbian|symbianos|fennec/i.test(navigator.userAgent.toLowerCase());return 1==a&&(BrowserDetect.TABLET=!1),!0===a},BrowserDetect.checkTablet=function(){var a=/ipad|sch-i800|playbook|xoom|tablet|gt-p1000|gt-p7510|sgh-t849|nexus 7|nexus 10|shw-m180s|a100|dell streak|silk/i.test(navigator.userAgent.toLowerCase());if(!0===/android/i.test(navigator.userAgent.toLowerCase())||!0===a){var a=screen.height,b=screen.width;a>b&&(b=screen.height,a=screen.width),a>=736&&b>=1024?a=!0:(BrowserDetect.MOBILE=!0,a=!1)}return 1==a&&(BrowserDetect.MOBILE=!1),!0===a},BrowserDetect.has3d=function(){var a,b=document.createElement("p"),c={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(b,null);for(var d in c)void 0!==b.style[d]&&(b.style[d]="translate3d(1px,1px,1px)",a=window.getComputedStyle(b).getPropertyValue(c[d]));return document.body.removeChild(b),void 0!==a&&0<a.length&&"none"!==a},BrowserDetect.BROWSER_NAME=null,BrowserDetect.BROWSER_VERSION=null,BrowserDetect.OS=null,BrowserDetect.DEVICE="",BrowserDetect.MOBILE=!1,BrowserDetect.TABLET=!1,BrowserDetect.DESKTOP=!1,BrowserDetect.CHROME=!1,BrowserDetect.SAFARI=!1,BrowserDetect.FIREFOX=!1,BrowserDetect.OPERA=!1,BrowserDetect.IE=!1,BrowserDetect.IE8=!1,BrowserDetect.IE9=!1,BrowserDetect.TRANSLATE3D_SUPPORT=BrowserDetect.has3d(),BrowserDetect.init(),Event.RESIZE="resize",Event.ORIENTATIONCHANGE="orientationchange",Event.LOAD="load",Event.SCROLL="scroll",Event.SELECT="select",Event.SUBMIT="submit",Event.HASHCHANGE="hashchange",Event.BLUR="blur",Event.PROGRESS="progress",Event.CHANGE="change",Event.ABORT="abort",Event.UNLOAD="unload",Event.BEFOREUNLOAD="beforeunload",Event.LOAD="load",Event.PROGRESS="progress",Event.ERROR="error",Event.CONTEXTMENU="contextmenu",Event.COPY="copy",Event.PASTE="paste",Event.READY_STATE_CHANGE="readystatechange",Event.RESET="reset",MouseEvent.CLICK="click",MouseEvent.MOUSE_DOWN="mousedown",MouseEvent.MOUSE_MOVE="mousemove",MouseEvent.MOUSE_UP="mouseup",MouseEvent.RIGHT_CLICK="rightclick",MouseEvent.MOUSE_OVER="mouseover",MouseEvent.MOUSE_OUT="mouseout",MouseEvent.DOUBLE_CLICK="dblclick",MouseEvent.FOCUS="focus",MouseEvent.MOUSE_ENTER="mouseenter",MouseEvent.MOUSE_LEAVE="mouseleave",MouseEvent.ROLL_OVER="mouseenter",MouseEvent.ROLL_OUT="mouseleave",MouseEvent.DRAG_END="dragend",MouseEvent.DRAG_ENTER="dragenter",MouseEvent.DRAG_LEAVE="dragleave",MouseEvent.DRAG_OVER="dragover",MouseEvent.DRAG_START="dragstart",MouseEvent.DROP="drop",MouseEvent.MOUSE_WHEEL="mousewheel","Firefox"==BrowserDetect.BROWSER_NAME&&(MouseEvent.MOUSE_WHEEL="DOMMouseScroll"),KeyboardEvent.KEY_DOWN="keydown",KeyboardEvent.KEY_UP="keyup",KeyboardEvent.KEY_PRESS="keypress",TouchEvent.TOUCH_START="touchstart",TouchEvent.TOUCH_MOVE="touchmove",TouchEvent.TOUCH_END="touchend",TouchEvent.TOUCH_CANCEL="touchcancel",1==BrowserDetect.TABLET||1==BrowserDetect.MOBILE?(MouseAndTouchEvent.MOUSE_DOWN=TouchEvent.TOUCH_START,MouseAndTouchEvent.MOUSE_MOVE=TouchEvent.TOUCH_MOVE,MouseAndTouchEvent.MOUSE_UP=TouchEvent.TOUCH_END,MouseAndTouchEvent.RESIZE=Event.ORIENTATIONCHANGE):(MouseAndTouchEvent.MOUSE_DOWN=MouseEvent.MOUSE_DOWN,MouseAndTouchEvent.MOUSE_MOVE=MouseEvent.MOUSE_MOVE,MouseAndTouchEvent.MOUSE_UP=MouseEvent.MOUSE_UP,MouseAndTouchEvent.RESIZE=Event.RESIZE),MessageEvent.MESSAGE="message",MediaEvent.ABORT="abort",MediaEvent.CANPLAY="canplay",MediaEvent.CAN_PLAY_THROUGH="canplaythrough",MediaEvent.DURATION_CHANGE="durationchange",MediaEvent.EMPTIED="emptied",MediaEvent.ENDED="ended",MediaEvent.ERROR="error",MediaEvent.LOADED_DATA="loadeddata",MediaEvent.LOADED_METADATA="loadedmetadata",MediaEvent.LOAD_START="loadstart",MediaEvent.PAUSE="pause",MediaEvent.PLAY="play",MediaEvent.PLAYING="playing",MediaEvent.PROGRESS="progress",MediaEvent.RATE_CHANGE="ratechange",MediaEvent.SEEKED="seeked",MediaEvent.SEEKING="seeking",MediaEvent.SUSPEND="suspend",MediaEvent.TIME_UPDATE="timeupdate",MediaEvent.VOLUME_CHANGE="volumechange",MediaEvent.WAITING="waiting";var CEvent=Class.extend({init:function(a,b){this.type=a,this.data=b,this.target}}),EventDispatcher=Class.extend({init:function(){this._listeners,this._scopes},addEventListener:function(a,b,c){void 0===this._listeners&&(this._listeners={}),void 0===this._scopes&&(this._scopes={});var d=this._listeners,e=this._scopes;void 0===d[a]&&(d[a]=[]),void 0===e[a]&&(e[a]=[]),-1===d[a].indexOf(b)&&(d[a].push(b),e[a].push(c))},hasEventListener:function(a,b,c){if(void 0===this._listeners)return!1;var d=this._listeners;return void 0!==d[a]&&-1!==d[a].indexOf(b)},removeEventListener:function(a,b,c){if(void 0!==this._listeners){var d=this._listeners[a],e=this._scopes[a];if(void 0!==d){var f=d.indexOf(b);-1!==f&&(d.splice(f,1),e.splice(f,1))}}},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners[a.type],c=this._scopes[a.type];if(void 0!==b){a.target=this;for(var d=(b.length,0);d<b.length;d++)void 0!=b[d]?b[d].call(c[d],a):trace("dispatchEvent - undefined")}}}}),ModelEvent=function(a){return a.VIEW_CHANGED="VIEW_CHANGED",a.DEFAULT_VIEW_CHANGED="DEFAULTVIEW_VIEW_CHANGED",a.PARAMETERS_CHANGED="PARAMETERS_CHANGED",a}({}),PageEvent=function(a){return a.ON_PAGE_MANAGER_CLEAR="onPageManagerClear",a.ON_HIDE="onHide",a.ON_CLEAR="onClear",a.ON_LOAD_PAGE="onLoadPage",a}({}),PageManagerEvent=function(a){return a.VIEW_CLEAR_HANDLER="viewClearHandler",a.PAGE_HIDE="pageHide",a}({}),ViewAddress=new function(){this.getValue=function(){return _value},this.getViewID=function(){return h},this.getPath=function(){var a=this.getValue();return-1!=a.indexOf("?")?a.split("?")[0]:-1!=a.indexOf("#")?a.split("#")[0]:a},this.getPathNames=function(){var a=this.getPath(),b=a.split("/");return"/"!=a.substr(0,1)&&0!=a.length||b.splice(0,1),"/"==a.substr(a.length-1,1)&&b.splice(b.length-1,1),b},this.getParameter=function(a){var b=this.getValue(),c=b.indexOf("?");if(-1!=c){b=b.substr(c+1);for(var d,e=b.split("&"),f=e.length,g=[];f--;)d=e[f].split("="),d[0]==a&&g.push(d[1]);if(0!=g.length)return 1!=g.length?g:g[0]}},this.getParameterNames=function(){var a=this.getValue(),b=a.indexOf("?"),c=[];if(-1!=b&&(a=a.substr(b+1),""!=a&&-1!=a.indexOf("=")))for(var d=a.split("&"),e=0;e<d.length;)c.push(d[e].split("=")[0]),e++;return c},this.setValue=function(b){h=b.split("#")[0],b=b.split("#")[1],typeof b==c&&(b=""),"null"==b&&(b=""),"/"==b&&(b=""),_value!=b&&(g=e,_value=b,a.call(this,"change"))};var a=function(a){this.dispatchEvent(new ViewAddressEvent(a)),a=a.substr(0,1).toUpperCase()+a.substr(1),typeof this["on"+a]==b&&this["on"+a]()};this.addEventListener=function(a,b){typeof d[a]==c&&(d[a]=[]),d[a].push(b)},this.dispatchEvent=function(a){if(this.hasEventListener(a.type)){a.target=this;for(var b,c=0;b=d[a.type][c];c++)b(a);return e}return f},this.hasEventListener=function(a){return typeof d[a]!=c&&d[a].length>0};var b="function",c="undefined",d={},e=!0,f=!1,g=e,h="viewaddress";_value=""},ViewAddressEvent=function(a){this.toString=function(){return"[object ViewAddressEvent]"},this.type=a,this.target=[ViewAddress][0],this.value=ViewAddress.getValue(),this.path=ViewAddress.getPath(),this.pathNames=ViewAddress.getPathNames(),this.parameters={};for(var b=ViewAddress.getParameterNames(),c=0,d=b.length;d>c;c++)this.parameters[b[c]]=ViewAddress.getParameter(b[c]);this.parameterNames=b};ViewAddressEvent.INIT="init",ViewAddressEvent.CHANGE="change",ViewAddressEvent.INTERNAL_CHANGE="internalChange",ViewAddressEvent.EXTERNAL_CHANGE="externalChange";var Model=function(a){function b(a,b){b="undefined"!=typeof b?b:Model.DEFAULT_VIEW,c(b),D[b]=a,s(new CEvent("blah"))}function c(a){x[a]=[new StructureObj]}function d(a){for(var b=0;b<Model.langs.length;b++)if(Model.langs[b]==a)return!0;return!1}function e(a){return a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,x[a]}function f(a,b){b="undefined"!=typeof b?b:Model.DEFAULT_VIEW,e(b)[e(b).length-1].fullUrl!=a[a.length-1].fullUrl&&s(new CEvent(b.toUpperCase()+"_VIEW_CHANGED")),x[b]=a,g(a,b),s(new CEvent(ModelEvent.VIEW_CHANGED))}function g(a,b){for(var c=0;c<Model.PMS[b].length;c++){var d=a[c]?a[c].id:null,e=Model.PMS[b][c]&&Model.PMS[b][c].getPageData()?Model.PMS[b][c].getPageData().id:null;if(d!=e)return void Model.PMS[b][c].setPageData(a[c])}}function h(a){return a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,D[a]}function i(a,b,c){b="undefined"!=typeof b?b:0,c="undefined"!=typeof c?c:Model.DEFAULT_VIEW,Model.PMS[c]||(Model.PMS[c]=[]),Model.PMS[c][b]=a}function j(a,b,c){b="undefined"!=typeof b?b:0,c="undefined"!=typeof c?c:Model.DEFAULT_VIEW;var d=Model.PMS[c][b]?Model.PMS[c][b].getKey():null,e=a?a.getKey():null;d==e&&Model.PMS[c].splice(b,1)}function k(a,b){b="undefined"!=typeof b?b:Model.DEFAULT_VIEW,C[b]=a}function l(a){return a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,C[a]}function m(a,b){b="undefined"!=typeof b?b:Model.DEFAULT_VIEW,B[b]=a}function n(a){return a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,B[a]||""}function o(a){return a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,e(a)[e(a).length-1].fullUrl}function p(a,b){b="undefined"!=typeof b?b:Model.DEFAULT_VIEW;for(var c="",d=0;a>d;d++)c+=e(b)[d].url+"/";return c}function q(a,b,c){t.removeEventListener(a,b,c)}function r(a,b,c){t.addEventListener(a,b,c)}function s(a){t.dispatchEvent(a)}var t=new EventDispatcher,u="secondView",v="defaultView",w=[],x=[],y=!1,z="pl",A=["pl","en"],B={},C={},D={};return a.removePageManager=j,a.urlLangs=y,a.lang=z,a.langs=A,a.isLangAvailable=d,a.addPageManager=i,a.getViewState=e,a.setViewState=f,a.getStructureData=h,a.getFullURL=o,a.getBaseURL=p,a.setHomeURL=m,a.getHomeURL=n,a.setParameters=k,a.getParameters=l,a.removeEventListener=q,a.addEventListener=r,a.dispatchEvent=s,a.setStructureData=b,a.DEFAULT_VIEW=v,a.SECOND_VIEW=u,a.PMS=w,a}({}),View=Class.extend({init:function(){this.initDom(),this.initView(),this.initEvents(),this.initController()},initDom:function(){this.elem=Dom.create("div",document.body,[".View","view"])},initView:function(){},initController:function(){AddressController.init()},initEvents:function(){Model.addEventListener(ModelEvent.DEFAULT_VIEW_CHANGED,this.viewChangedHandler.bind(this)),this.resizeEventID=this.resize.bind(this),this.orientationEventID=this.orientationchange.bind(this),window.addEventListener("resize",this.resizeEventID),window.addEventListener("orientationchange",this.orientationEventID),this.resize()},viewChangedHandler:function(){setTimeout(this.resizeEventID,100)},orientationchange:function(){setTimeout(this.resizeEventID,100)},resize:function(){}}),Page=EventDispatcher.extend({init:function(a){"undefined"==typeof a&&trace("Page: ELEM NIE MOZE BYC null"),this._container,this._elem=a,this._key,this._active,this._freeze=!0,this._current,this._pageManager,this._pageManagerLevel=0,this._data,this._viewId,this._pageManagerClass="PageManager"},activate:function(a){this._data=a,this._active||(this._active=!0,this.loadData())},loadData:function(){this.initialize()},initialize:function(){this._container=document.createElement("div"),this._container.setAttribute("page-id",this._data.title),this._container.setAttribute("class",this._data.className),this._container.setAttribute("Page",this._data.url),this._elem.appendChild(this._container),this._pageManager=new window[this._pageManagerClass](this._data.structureLevel+1,!0,Utils.stringToBoolean(this._data.atOnce),this.getViewId(),this._data),this.startPageManager(),this._pageManager.addEventListener(PageEvent.ON_PAGE_MANAGER_CLEAR,this.pageManagerClearHandler,this),this.initContent()},startPageManager:function(){this._pageManager.start(this._container)},initContent:function(){this._div=document.createElement("div"),this._div.setAttribute("class","rect-green"),this._container.appendChild(this._div)},hide:function(){this._active&&(this._active=!1,this.individualHide())},individualHide:function(){this._pageManager&&this._pageManager.setPageData(null)},hideAndDestroy:function(){this.destroyPage()},pageManagerClearHandler:function(a){this._pageManager&&(this._pageManager.removeEventListener(PageEvent.ON_PAGE_MANAGER_CLEAR,this.pageManagerClearHandler,this),this._container.parentNode&&this._container.parentNode.removeChild(this._container),this._pageManager=null),this.hideAndDestroy()},destroyPage:function(){this.dispatchEvent(new CEvent(PageEvent.ON_CLEAR))},getKey:function(){return this._key},setKey:function(a){this._key=a},getPageManagerLevel:function(){return this._pageManagerLevel},setPageManagerLevel:function(a){this._pageManagerLevel=a},getData:function(){return this._data},setData:function(a){this._data=a},getPageManager:function(){return this._pageManager},setPageManager:function(a){this._pageManager=a},getViewId:function(){return this._viewId},setViewId:function(a){this._viewId=a},getCurrent:function(){return this._data.fullUrl=="/"+Model.getHomeURL(this._viewId)&&(Model.getFullURL(this._viewId)==this._data.fullUrl||"/"==Model.getFullURL(this._viewId))||Model.getFullURL(this._viewId)==this._data.fullUrl},getActive:function(){return this._active},getPageManagerClass:function(){return this._pageManagerClass},setPageManagerClass:function(a){this._pageManagerClass=a}}),PageManager=EventDispatcher.extend({init:function(a,b,c,d,e){a="undefined"!=typeof a?a:0,b="undefined"!=typeof b?b:!1,c="undefined"!=typeof c?c:!1,d="undefined"!=typeof d?d:Model.DEFAULT_VIEW,this._level=a,this._key=1e17*Math.random(),this._page,this._pageClass,this._pageData,this._pageURL,this._autoFirstPage=!1,this._randomPage,this._kill=!0,this._atOnce=c,this._viewId=d,this._data=e,this._elem=null},start:function(a){this._elem=a,Model.addPageManager(this,this._level,this._viewId),Model.setViewState(Model.getViewState(this._viewId),this._viewId),Model.getViewState(this._viewId)[this._level-1]&&(this._pageURL=Model.getViewState(this._viewId)[this._level-1].fullUrl)},setPageData:function(a){this._pageData=a;Model.getViewState(this._viewId)[this._level-1],Model.getViewState(this._viewId)[this._level-2];this._kill=!(Model.getViewState(this._viewId)[this._level-1]&&Model.getViewState(this._viewId)[this._level-1].fullUrl==this._pageURL&&Model.PMS[this._viewId][0].getPageData()),a?this.setPageClass(this._pageData.className):this.setPageClass(null)},getPageData:function(){return this._pageData},getLevel:function(){return this._level},getCurrentPage:function(){return this._page},setPageClass:function(a){this._pageClass=a,this.switchPage()},switchPage:function(){this._page?this.unloadPage():this._pageClass?this.loadPage():this.clear()},loadPage:function(){this._pageData.structureLevel=this._level,this._page=new window[this._pageClass](this._elem),this._page.setViewId(this._viewId),this._page.setKey(1e17*Math.random()),this._page.addEventListener(PageEvent.ON_CLEAR,this.onPageUnload,this),this._page.activate(this._pageData),this.dispatchEvent(new CEvent(PageEvent.ON_LOAD_PAGE))},unloadPage:function(){this._page?(this._page.hide(),this._atOnce&&this._pageData&&this.loadPage(),this._atOnce&&this._kill&&this._level&&Model.removePageManager(this,this._level,this._viewId),this.dispatchEvent(new CEvent(PageManagerEvent.PAGE_HIDE))):this.clear()},onPageUnload:function(a){a.target.removeEventListener(PageEvent.ON_CLEAR,this.onPageUnload,this),this._atOnce||(this._page=null),this._pageClass?this._atOnce||this.loadPage():(this._page=null,this.clear())},getAtOnce:function(){return this._atOnce},setAtOnce:function(a){this._atOnce=a},clear:function(){this._level?this._kill&&(Model.removePageManager(this,this._level,this._viewId),this._elem.parentNode.removeChild(this._elem),this.dispatchEvent(new CEvent(PageEvent.ON_PAGE_MANAGER_CLEAR))):this.dispatchEvent(new CEvent(PageManagerEvent.VIEW_CLEAR_HANDLER))},getKey:function(){return this._key},toString:function(){return"[ PageManager ][_viewId: "+this._viewId+"][_level: "+this._level+"]"}}),HistoryAddress=function(a){function b(a){q=a.state,r=window.title,p=t.location.pathname,n(new HistoryAddressEvent(HistoryAddressEvent.CHANGE))}function c(a,b){return b?"/"!=a.substr(0,1)&&(a="/"+a):""==a&&(a="/"),a||""}function d(a){o=a}function e(a){return""!=o&&a.unshift(o),a}function f(a){return a.length&&o==a[0]&&a.shift(),a}function g(a,b,d){b=b||null,d=d||null,"undefined"!=a&&null!=a||(a=""),"/"==a&&(a=""),p!=a&&(names=e(a.replace(/^\/|\/$/g,"").split("/")),a=names.join("/"),p=a,u.pushState(d,b,c(p,!0)),n(new HistoryAddressEvent(HistoryAddressEvent.CHANGE)))}function h(){var a=c(p||"",!1),b=a.split("/");return b=f(a.split("/")),a=b.join("/")}function i(){var a=h();return-1!=a.indexOf("?")?a.split("?")[0]:a}function j(){var a=i(),b=a.split("/");return"/"!=a.substr(0,1)&&0!=a.length||b.splice(0,1),"/"==a.substr(a.length-1,1)&&b.splice(b.length-1,1),b}function k(){var a=h(),b=a.indexOf("?"),c=[];if(-1!=b&&(a=a.substr(b+1),""!=a&&-1!=a.indexOf("=")))for(var d=a.split("&"),e=0;e<d.length;)c.push(d[e].split("=")[0]),e++;return c}function l(a,b,c){s.removeEventListener(a,b,c)}function m(a,b,c){s.addEventListener(a,b,c)}function n(a){s.dispatchEvent(a)}var o="",p=window.location.pathname,q={},r="",s=new EventDispatcher,t=window,u=window.history;window.location,window.document,!(!window.history||!history.pushState);return t.addEventListener("popstate",b),a.dispatchEvent=n,a.addEventListener=m,a.removeEventListener=l,a.getParameterNames=k,a.getValue=h,a.setValue=g,a.setPrefix=d,a.removePrefix=f,a.getPath=i,a.getPathNames=j,a}({}),HistoryAddressEvent=function(a){this.toString=function(){return"[object ViewAddressEvent]"},this.type=a,this.target=[HistoryAddress][0],this.value=HistoryAddress.getValue(),this.path=HistoryAddress.getPath(),this.pathNames=HistoryAddress.getPathNames(),this.parameters={};for(var b=HistoryAddress.getParameterNames(),c=0,d=b.length;d>c;c++)this.parameters[b[c]]=HistoryAddress.getParameter(b[c]);this.parameterNames=b};HistoryAddressEvent.INIT="init",HistoryAddressEvent.CHANGE="change",HistoryAddressEvent.INTERNAL_CHANGE="internalChange",HistoryAddressEvent.EXTERNAL_CHANGE="externalChange";var AddressController=function(a){function b(a,b){j=a||"",HistoryAddress.setPrefix(b||""),HistoryAddress.addEventListener(HistoryAddressEvent.CHANGE,c),SWFAddress.addEventListener(SWFAddressEvent.CHANGE,e),ViewAddress.addEventListener(ViewAddressEvent.CHANGE,d),SWFAddress.dispatchEvent(new SWFAddressEvent(SWFAddressEvent.CHANGE)),HistoryAddress.dispatchEvent(new HistoryAddressEvent(HistoryAddressEvent.CHANGE)),ViewAddress.dispatchEvent(new ViewAddressEvent(ViewAddressEvent.CHANGE))}function c(a){var b=Model.getParameters();a.parameters.string=String(a.value).split("?")[1]||"",Model.setParameters(a.parameters);var c=HistoryAddress.removePrefix(a.pathNames);if(Model.urlLangs&&c.length&&Model.isLangAvailable(c[0])){c.shift()}h(c,a.path),b!=Model.getParameters().string&&Model.dispatchEvent(new CEvent(ModelEvent.PARAMETERS_CHANGED))}function d(a){if(Model.PMS[ViewAddress.getViewID()]){Model.getParameters(ViewAddress.getViewID());a.parameters.string=String(a.value).split("?")[1]||"",Model.setParameters(a.parameters,ViewAddress.getViewID()),h(a.pathNames,a.path,ViewAddress.getViewID())}}function e(a){var b=Model.getParameters();if(a.parameters.string=String(a.value).split("?")[1]||"",Model.setParameters(a.parameters),Model.urlLangs&&a.pathNames.length&&Model.isLangAvailable(a.pathNames[0])){a.pathNames.shift()}h(a.pathNames,a.path,Model.SECOND_VIEW),b!=Model.getParameters().string&&Model.dispatchEvent(new CEvent(ModelEvent.PARAMETERS_CHANGED))}function f(a,b){return b="undefined"!=typeof b?b:Model.DEFAULT_VIEW,"undefined"!=typeof a&&a.split("#").length>1&&(b=a.split("#")[0],a=a.split("#")[a.split("#").length-1]),-1!=a.indexOf("http://")?void window.open(a,"_blank"):void(b==Model.DEFAULT_VIEW?(Model.urlLangs&&(a=Model.lang+"/"+a),HistoryAddress.setValue(a)):b==Model.SECOND_VIEW?SWFAddress.setValue(a):ViewAddress.setValue(b+"#"+a.split("#")[a.split("#").length-1]))}function g(a){a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,f(Model.getHomeURL(a),a)}function h(a,b,c){c="undefined"!=typeof c?c:Model.DEFAULT_VIEW;for(var d=Model.getStructureData(c),e=[],f=0;f<a.length;f++)if(d){if(!i(a[f],d))return void g(c);e.push(i(a[f],d)),d=i(a[f],d).children}if(a.length||(_s=i(Model.getHomeURL(c),d),_s&&e.push(_s)),e.length)for(;e[e.length-1]&&e[e.length-1].autoFirstPage&&e[e.length-1].getChildrenArray().length;){var h=e[e.length-1].getChildrenArray(),j=h.length-1;if(e[e.length-1].randomPage&&j>0){var k=Math.round(Math.random()*j);_s=i(h[k].url,e[e.length-1].children)}else _s=i(h[0].url,e[e.length-1].children);_s&&e.push(_s)}e.length&&Model.setViewState(e,c)}function i(a,b){for(var c in b)if(a==b[c].url)return b[c];return null}var j;return a.init=b,a.getURL=f,a}({});!function(){var a=document.getElementsByTagName("head")[0]||document.documentElement;return this.load=function(b){
var c;c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),b.url=b.url||location.href,b.data=b.data||null,b.type=b.type||"json",b.action=b.action||"GET";var d=b.callback||function(){},e=b.callbackError||function(){};if("jsonp"==b.type){var f="_"+Math.random().toString(36).substring(7),g=document.createElement("script");window[f]=function(a){d(a)},b.url=b.url.replace("callback=?","callback="+f),g.src=b.url,a.appendChild(g)}else"json"==b.type&&(c.onreadystatechange=function(){4==c.readyState&&(300>c.status?(d(c.responseText),c=c.onreadystatechange=null):300<c.status&&(e(),c=c.onreadystatechange=null))});return c.open(b.action,b.url,!0),c.send(b.data),c},window.StructureLoader=this,this}();var StructureObj=function(){function a(){}function b(){var b=[];for(var c in this.children)this.children[c].constructor==a&&b.push(this.children[c]);return b}function c(){var b=[];for(var c in this)this[c].constructor==a&&b.push(this[c]);return b}var d=a.prototype;return d.id=0,d.name="",d.url="",d.className="",d.depth=0,d.parent_id,d.fullUrl="",d.children,d.parent,d.autoFirstPage=!1,d.randomPage=!1,d.hidden=!1,d.JSON,d.getChildrenArray=b,d.getAsArray=c,a}(),StructureUtils=function(a){function b(a){}function c(a){for(var b="[]",c=0;a>c;c++)b+="------[]";return b}function d(a){window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(a,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=!1,xmlDoc.loadXML(a));var c=new StructureObj;b("- S - T - R - U - C - T - U - R - E - - - - - - - - - - - - - - - - - - ");var d=xmlDoc.getElementsByTagName("pages")[0].childNodes,g=1;return f(e(d),c,g),b("- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - "),c.children}function e(a){for(var b=[],c=0;c<a.length;c++)node=a[c],"page"==node.nodeName&&b.push(node);return b}function f(a,d,g){for(var h=d.children||new StructureObj,i=0;i<a.length;i++){var j=(e(a[i].childNodes),a[i].attributes),k=j.url.value;++g,h[k]=new StructureObj;for(var l=0;l<j.length;l++)h[k][j[l].name]=j[l].value;h[k].parentId=d.id,h[k].id=g,h[k].fullUrl=(d.fullUrl||"")+"/"+h[k].url,h[k].depth=d.depth+1,h[k].ord=g,h[k].parent=d;for(var m=a[i].childNodes,n=0;n<m.length;n++)___node=m[n],"page"==___node.nodeName?f(e(___node.childNodes),h[k],g):"#text"!=___node.nodeName&&(h[k][___node.nodeName]=___node.firstChild.nodeValue);b(c(d.depth+1)+"["+k+" | className:"+h[k].className+"] ")}d.children=h}function g(a){var c=new StructureObj;return b("- S - T - R - U - C - T - U - R - E - - - - - - - - - - - - - - - - - - "),h(a.page,c),b("- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - "),c.children}function h(a,c){var d=c.children||new StructureObj;b(d.url+" URL");for(var e=0;e<a.children.length;e++){var f="",g="",i=!1;a.children[e].custom_fields&&(f=a.children[e].custom_fields.url,g=a.children[e].custom_fields.className,i=Utils.stringToBoolean(a.children[e].custom_fields.autoFirstPage)),d[f]=new StructureObj;for(var j in a.children[e])switch(j){case"parent":case"children":break;default:d[f][j]=a.children[e][j]}b(f+" - URL"),d[f].className=g,d[f].url=f,d[f].autoFirstPage=i,d[f].parentId=c.id,d[f].fullUrl=(c.fullUrl||"")+"/"+d[f].url,d[f].depth=c.depth+1,d[f].ord=e,d[f].parent=c,d[f].JSON="vvv",a.children[e].children.length&&h(a.children[e],d[f])}c.children=d}return a.getStructureFromXML=d,a.getStructureFromJSON=g,a}({});