!function(){var a=!1,b=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(c){function d(){!a&&this.init&&this.init.apply(this,arguments)}var e=this.prototype;a=!0;var f=new this;a=!1;for(var g in c)f[g]="function"==typeof c[g]&&"function"==typeof e[g]&&b.test(c[g])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);return this._super=c,d}}(g,c[g]):c[g];return d.prototype=f,d.prototype.constructor=d,d.extend=arguments.callee,d}}();var ViewAddress=new function(){this.getValue=function(){return _value},this.getViewID=function(){return h},this.getPath=function(){var a=this.getValue();return-1!=a.indexOf("?")?a.split("?")[0]:-1!=a.indexOf("#")?a.split("#")[0]:a},this.getPathNames=function(){var a=this.getPath(),b=a.split("/");return("/"==a.substr(0,1)||0==a.length)&&b.splice(0,1),"/"==a.substr(a.length-1,1)&&b.splice(b.length-1,1),b},this.getParameter=function(a){var b=this.getValue(),c=b.indexOf("?");if(-1!=c){b=b.substr(c+1);for(var d,e=b.split("&"),f=e.length,g=[];f--;)d=e[f].split("="),d[0]==a&&g.push(d[1]);if(0!=g.length)return 1!=g.length?g:g[0]}},this.getParameterNames=function(){var a=this.getValue(),b=a.indexOf("?"),c=[];if(-1!=b&&(a=a.substr(b+1),""!=a&&-1!=a.indexOf("=")))for(var d=a.split("&"),e=0;e<d.length;)c.push(d[e].split("=")[0]),e++;return c},this.setValue=function(b){h=b.split("#")[0],b=b.split("#")[1],typeof b==c&&(b=""),"null"==b&&(b=""),"/"==b&&(b=""),_value!=b&&(g=e,_value=b,a.call(this,"change"))};var a=function(a){this.dispatchEvent(new ViewAddressEvent(a)),a=a.substr(0,1).toUpperCase()+a.substr(1),typeof this["on"+a]==b&&this["on"+a]()};this.addEventListener=function(a,b){typeof d[a]==c&&(d[a]=[]),d[a].push(b)},this.dispatchEvent=function(a){if(this.hasEventListener(a.type)){a.target=this;for(var b,c=0;b=d[a.type][c];c++)b(a);return e}return f},this.hasEventListener=function(a){return typeof d[a]!=c&&d[a].length>0};var b="function",c="undefined",d={},e=!0,f=!1,g=e,h="viewaddress";_value=""},ViewAddressEvent=function(a){this.toString=function(){return"[object ViewAddressEvent]"},this.type=a,this.target=[ViewAddress][0],this.value=ViewAddress.getValue(),this.path=ViewAddress.getPath(),this.pathNames=ViewAddress.getPathNames(),this.parameters={};for(var b=ViewAddress.getParameterNames(),c=0,d=b.length;d>c;c++)this.parameters[b[c]]=ViewAddress.getParameter(b[c]);this.parameterNames=b};ViewAddressEvent.INIT="init",ViewAddressEvent.CHANGE="change",ViewAddressEvent.INTERNAL_CHANGE="internalChange",ViewAddressEvent.EXTERNAL_CHANGE="externalChange";var ModelEvent=function(a){return a.VIEW_CHANGED="VIEW_CHANGED",a.DEFAULT_VIEW_CHANGED="DEFAULTVIEW_VIEW_CHANGED",a.PARAMETERS_CHANGED="PARAMETERS_CHANGED",a}({}),Model=function(a){function b(a,b){b="undefined"!=typeof b?b:Model.DEFAULT_VIEW,c(b),D[b]=a,t(new CEvent("blah"))}function c(a){x[a]=[new StructureObj]}function d(a){for(var b=0;b<Model.langs.length;b++)if(Model.langs[b]==a)return!0;return!1}function e(a){return a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,x[a]}function f(a,b){b="undefined"!=typeof b?b:Model.DEFAULT_VIEW,e(b)[e(b).length-1].fullUrl!=a[a.length-1].fullUrl&&t(new CEvent(b.toUpperCase()+"_VIEW_CHANGED")),x[b]=a,g(a,b),t(new CEvent(ModelEvent.VIEW_CHANGED))}function g(a,b){for(var c=0;c<Model.PMS[b].length;c++){var d=a[c]?a[c].id:null,e=Model.PMS[b][c]&&Model.PMS[b][c].getPageData()?Model.PMS[b][c].getPageData().id:null;if(d!=e)return void Model.PMS[b][c].setPageData(a[c])}}function h(a,b){b="undefined"!=typeof b?b:Model.DEFAULT_VIEW,"undefined"!=typeof a&&(a.split("#").length>1&&(b=a.split("#")[0],a=a.split("#")[a.split("#").length-1]),b==Model.DEFAULT_VIEW?-1!=a.indexOf("http://")?window.open(a,"_blank"):(Model.urlLangs&&(a=Model.lang+"/"+a),SWFAddress.setValue(a)):ViewAddress.setValue(b+"#"+a.split("#")[a.split("#").length-1]))}function i(a){return a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,D[a]}function j(a,b,c){b="undefined"!=typeof b?b:0,c="undefined"!=typeof c?c:Model.DEFAULT_VIEW,Model.PMS[c]||(Model.PMS[c]=[]),Model.PMS[c][b]=a}function k(a,b,c){b="undefined"!=typeof b?b:0,c="undefined"!=typeof c?c:Model.DEFAULT_VIEW;var d=Model.PMS[c][b]?Model.PMS[c][b].getKey():null,e=a?a.getKey():null;d==e&&Model.PMS[c].splice(b,1)}function l(a,b){b="undefined"!=typeof b?b:Model.DEFAULT_VIEW,C[b]=a}function m(a){return a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,C[a]}function n(a,b){b="undefined"!=typeof b?b:Model.DEFAULT_VIEW,B[b]=a}function o(a){return a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,B[a]||""}function p(a){return a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,e(a)[e(a).length-1].fullUrl}function q(a,b){b="undefined"!=typeof b?b:Model.DEFAULT_VIEW;for(var c="",d=0;a>d;d++)c+=e(b)[d].url+"/";return c}function r(a,b,c){u.removeEventListener(a,b,c)}function s(a,b,c){u.addEventListener(a,b,c)}function t(a){u.dispatchEvent(a)}var u=new EventDispatcher,v="defaultView",w=[],x=[],y=!0,z="pl",A=["pl","en"],B={},C={},D={};return a.removePageManager=k,a.urlLangs=y,a.lang=z,a.langs=A,a.isLangAvailable=d,a.addPageManager=j,a.getViewState=e,a.setViewState=f,a.getStructureData=i,a.getURL=h,a.getFullURL=p,a.getBaseURL=q,a.setHomeURL=n,a.getHomeURL=o,a.setParameters=l,a.getParameters=m,a.removeEventListener=r,a.addEventListener=s,a.dispatchEvent=t,a.setStructureData=b,a.DEFAULT_VIEW=v,a.PMS=w,a}({}),View=Class.extend({init:function(){this.initView()},initView:function(){elem=Dom.create("div",document.body,[".View","view"]),this.pmContainer=Dom.create("div",elem,[".PageManager","#mainPM"]),this.pmContainer.style.zIndex=50,this.pm=new PageManager(this.pmContainer),this.pm.start(),Model.addEventListener(ModelEvent.DEFAULT_VIEW_CHANGED,this.viewChangedHandler.bind(this)),Model.setHomeURL("home"),AddressController.init(),this.resizeEventID=this.resize.bind(this),this.orientationEventID=this.orientationchange.bind(this),window.addEventListener("resize",this.resizeEventID),window.addEventListener("orientationchange",this.orientationEventID),this.resize()},viewChangedHandler:function(){setTimeout(this.resizeEventID,100)},orientationchange:function(){setTimeout(this.resizeEventID,100)},resize:function(){}}),PageEvent=function(a){return a.ON_PAGE_MANAGER_CLEAR="onPageManagerClear",a.ON_HIDE="onHide",a.ON_CLEAR="onClear",a.ON_LOAD_PAGE="onLoadPage",a}({}),Page=EventDispatcher.extend({init:function(a){"undefined"==typeof a&&trace("Page: ELEM NIE MOZE BYC null"),this._container,this._elem=a,this._key,this._active,this._freeze=!0,this._current,this._pageManager,this._pageManagerLevel=0,this._data,this._viewId,this._pageManagerClass="PageManager"},activate:function(a){this._data=a,this._active||(this._active=!0,this.loadData())},loadData:function(){this.initialize()},initialize:function(){this._container=document.createElement("div"),this._container.setAttribute("page-id",this._data.title),this._container.setAttribute("class",this._data.className),this._container.setAttribute("Page",this._data.url),this._elem.appendChild(this._container),this._pageManager=new window[this._pageManagerClass](this._container,this._data.structureLevel+1,!0,Utils.stringToBoolean(this._data.atOnce),this.getViewId(),this._data),this._pageManager.start(),this._pageManager.addEventListener(PageEvent.ON_PAGE_MANAGER_CLEAR,this.pageManagerClearHandler,this),this.initContent()},initContent:function(){this._div=document.createElement("div"),this._div.setAttribute("class","rect-green"),this._container.appendChild(this._div)},hide:function(){this._active&&(this._active=!1,this.individualHide())},individualHide:function(){this._pageManager&&this._pageManager.setPageData(null)},hideAndDestroy:function(){this.destroyPage()},pageManagerClearHandler:function(a){this._pageManager&&(this._pageManager.removeEventListener(PageEvent.ON_PAGE_MANAGER_CLEAR,this.pageManagerClearHandler,this),this._pageManager=null),this.hideAndDestroy()},destroyPage:function(){this.dispatchEvent(new CEvent(PageEvent.ON_CLEAR))},getKey:function(){return this._key},setKey:function(a){this._key=a},getPageManagerLevel:function(){return this._pageManagerLevel},setPageManagerLevel:function(a){this._pageManagerLevel=a},getData:function(){return this._data},setData:function(a){this._data=a},getPageManager:function(){return this._pageManager},setPageManager:function(a){this._pageManager=a},getViewId:function(){return this._viewId},setViewId:function(a){this._viewId=a},getCurrent:function(){return this._data.fullUrl=="/"+Model.getHomeURL(this._viewId)&&(Model.getFullURL(this._viewId)==this._data.fullUrl||"/"==Model.getFullURL(this._viewId))||Model.getFullURL(this._viewId)==this._data.fullUrl},getActive:function(){return this._active},getPageManagerClass:function(){return this._pageManagerClass},setPageManagerClass:function(a){this._pageManagerClass=a}}),PageManagerEvent=function(a){return a.VIEW_CLEAR_HANDLER="viewClearHandler",a.PAGE_HIDE="pageHide",a}({}),PageManager=EventDispatcher.extend({init:function(a,b,c,d,e,f){b="undefined"!=typeof b?b:0,c="undefined"!=typeof c?c:!1,d="undefined"!=typeof d?d:!1,e="undefined"!=typeof e?e:Model.DEFAULT_VIEW,this._level=b,this._key=1e17*Math.random(),this._page,this._pageClass,this._pageData,this._pageURL,this._autoFirstPage=!1,this._randomPage,this._kill=!0,this._atOnce=d,this._viewId=e,this._data=f,this._elem=a},start:function(){Model.addPageManager(this,this._level,this._viewId),Model.setViewState(Model.getViewState(this._viewId),this._viewId),Model.getViewState(this._viewId)[this._level-1]&&(this._pageURL=Model.getViewState(this._viewId)[this._level-1].fullUrl)},setPageData:function(a){this._pageData=a;Model.getViewState(this._viewId)[this._level-1],Model.getViewState(this._viewId)[this._level-2];this._kill=!(Model.getViewState(this._viewId)[this._level-1]&&Model.getViewState(this._viewId)[this._level-1].fullUrl==this._pageURL&&Model.PMS[this._viewId][0].getPageData()),a?this.setPageClass(this._pageData.className):this.setPageClass(null)},getPageData:function(){return this._pageData},getLevel:function(){return this._level},getCurrentPage:function(){return this._page},setPageClass:function(a){this._pageClass=a,this.switchPage()},switchPage:function(){this._page?this.unloadPage():this._pageClass?this.loadPage():this.clear()},loadPage:function(){this._pageData.structureLevel=this._level,this._page=new window[this._pageClass](this._elem),this._page.setViewId(this._viewId),this._page.setKey(1e17*Math.random()),this._page.addEventListener(PageEvent.ON_CLEAR,this.onPageUnload,this),this._page.activate(this._pageData),this.dispatchEvent(new CEvent(PageEvent.ON_LOAD_PAGE))},unloadPage:function(){this._page?(this._page.hide(),this._atOnce&&this._pageData&&this.loadPage(),this._atOnce&&this._kill&&this._level&&Model.removePageManager(this,this._level,this._viewId),this.dispatchEvent(new CEvent(PageManagerEvent.PAGE_HIDE))):this.clear()},onPageUnload:function(a){a.target.removeEventListener(PageEvent.ON_CLEAR,this.onPageUnload,this),this._atOnce||(this._page=null),this._pageClass?this._atOnce||this.loadPage():(this._page=null,this.clear())},getAtOnce:function(){return this._atOnce},setAtOnce:function(a){this._atOnce=a},clear:function(){this._level?this._kill&&(Model.removePageManager(this,this._level,this._viewId),this._elem.parentNode.removeChild(this._elem),this.dispatchEvent(new CEvent(PageEvent.ON_PAGE_MANAGER_CLEAR))):this.dispatchEvent(new CEvent(PageManagerEvent.VIEW_CLEAR_HANDLER))},getKey:function(){return this._key},toString:function(){return"[ PageManager ][_viewId: "+this._viewId+"][_level: "+this._level+"]"}}),AddressController=function(a){function b(a){i=a||"",SWFAddress.addEventListener(SWFAddressEvent.CHANGE,e);String(SWFAddress.getValue());HistoryController.addEventListener(HistoryControllerEvent.CHANGE,c),ViewAddress.addEventListener(ViewAddressEvent.CHANGE,d),SWFAddress.dispatchEvent(new SWFAddressEvent(SWFAddressEvent.CHANGE)),ViewAddress.dispatchEvent(new ViewAddressEvent(ViewAddressEvent.CHANGE))}function c(a){}function d(a){if(Model.PMS[ViewAddress.getViewID()]){Model.getParameters(ViewAddress.getViewID());a.parameters.string=String(a.value).split("?")[1]||"",Model.setParameters(a.parameters,ViewAddress.getViewID()),g(a.pathNames,a.path,ViewAddress.getViewID())}}function e(a){trace("###  pathNames  "+a.pathNames),trace("###  handleSWFAddress  "+a.path);var b=Model.getParameters();if(a.parameters.string=String(a.value).split("?")[1]||"",Model.setParameters(a.parameters),Model.urlLangs&&a.pathNames.length&&Model.isLangAvailable(a.pathNames[0])){var c=a.pathNames.shift();trace(":) got lang: "+c)}else trace("no lang!");g(a.pathNames,a.path),b!=Model.getParameters().string&&Model.dispatchEvent(new CEvent(ModelEvent.PARAMETERS_CHANGED))}function f(a){a="undefined"!=typeof a?a:Model.DEFAULT_VIEW,Model.getURL(Model.getHomeURL(a),a)}function g(a,b,c){c="undefined"!=typeof c?c:Model.DEFAULT_VIEW;for(var d=Model.getStructureData(c),e=[],g=0;g<a.length;g++)if(d){if(!h(a[g],d))return void f(c);e.push(h(a[g],d)),d=h(a[g],d).children}if(a.length||(_s=h(Model.getHomeURL(c),d),_s&&e.push(_s)),e.length)for(;e[e.length-1]&&e[e.length-1].autoFirstPage&&e[e.length-1].getChildrensArray().length;){var i=e[e.length-1].getChildrensArray(),j=i.length-1;if(e[e.length-1].randomPage&&j>0){var k=Math.round(Math.random()*j);_s=h(i[k].url,e[e.length-1].children)}else _s=h(i[0].url,e[e.length-1].children);_s&&e.push(_s)}Model.setViewState(e,c)}function h(a,b){for(var c in b)if(a==b[c].url)return b[c];return null}var i;return a.init=b,a}({}),HistoryController=new function(){this.getValue=function(){return _value},this.getViewID=function(){return h},this.getPath=function(){var a=this.getValue();return-1!=a.indexOf("?")?a.split("?")[0]:-1!=a.indexOf("#")?a.split("#")[0]:a},this.getPathNames=function(){var a=this.getPath(),b=a.split("/");return("/"==a.substr(0,1)||0==a.length)&&b.splice(0,1),"/"==a.substr(a.length-1,1)&&b.splice(b.length-1,1),b},this.getParameter=function(a){var b=this.getValue(),c=b.indexOf("?");if(-1!=c){b=b.substr(c+1);for(var d,e=b.split("&"),f=e.length,g=[];f--;)d=e[f].split("="),d[0]==a&&g.push(d[1]);if(0!=g.length)return 1!=g.length?g:g[0]}},this.getParameterNames=function(){var a=this.getValue(),b=a.indexOf("?"),c=[];if(-1!=b&&(a=a.substr(b+1),""!=a&&-1!=a.indexOf("=")))for(var d=a.split("&"),e=0;e<d.length;)c.push(d[e].split("=")[0]),e++;return c},this.setValue=function(b){h=b.split("#")[0],b=b.split("#")[1],typeof b==c&&(b=""),"null"==b&&(b=""),"/"==b&&(b=""),_value!=b&&(g=e,_value=b,a.call(this,"change"))};var a=function(a){this.dispatchEvent(new HistoryControllerEvent(a)),a=a.substr(0,1).toUpperCase()+a.substr(1),typeof this["on"+a]==b&&this["on"+a]()};this.addEventListener=function(a,b){typeof d[a]==c&&(d[a]=[]),d[a].push(b)},this.dispatchEvent=function(a){if(this.hasEventListener(a.type)){a.target=this;for(var b,c=0;b=d[a.type][c];c++)b(a);return e}return f},this.hasEventListener=function(a){return typeof d[a]!=c&&d[a].length>0};var b="function",c="undefined",d={},e=!0,f=!1,g=e,h="historyController";_value=""},HistoryControllerEvent=function(a){this.toString=function(){return"[object HistoryControllerEvent]"},this.type=a,this.target=[HistoryController][0],this.value=Model.lang.getValue(),this.path=Model.lang.getPath(),this.pathNames=Model.lang.getPathNames(),this.parameters={};for(var b=Model.lang.getParameterNames(),c=0,d=b.length;d>c;c++)this.parameters[b[c]]=Model.lang.getParameter(b[c]);this.parameterNames=b};HistoryControllerEvent.INIT="init",HistoryControllerEvent.CHANGE="change",HistoryControllerEvent.INTERNAL_CHANGE="internalChange",HistoryControllerEvent.EXTERNAL_CHANGE="externalChange";